# üìã –û—Ç—á—ë—Ç –æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ OCR –ø–∞–π–ø–ª–∞–π–Ω–∞ –¥–ª—è Documentor

## üéØ –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

–í —Ä–∞–º–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ Documentor –±—ã–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π OCR –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ PDF –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö AI –º–æ–¥–µ–ª–µ–π. –ü–∞–π–ø–ª–∞–π–Ω –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç `dots.ocr` –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ layout –∏ `Qwen2.5-VL-7B-Instruct` –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞.

## üöÄ –ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

### ‚úÖ 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏–º–ø–æ—Ä—Ç–æ–≤
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ê–±—Å–æ–ª—é—Ç–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã —Å–Ω–∏–∂–∞–ª–∏ –ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å –∫–æ–¥–∞
- **–†–µ—à–µ–Ω–∏–µ**: –ü–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –Ω–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ (`from .module import`)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –£–ª—É—á—à–µ–Ω–∞ –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å –∏ –ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å –∫–æ–¥–∞

### ‚úÖ 2. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤
–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —Ç–∏–ø—ã —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è layout:
- `CaptionFragment` - –ø–æ–¥–ø–∏—Å–∏ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º/—Ç–∞–±–ª–∏—Ü–∞–º
- `FootnoteFragment` - —Å–Ω–æ—Å–∫–∏
- `ListItemFragment` - —ç–ª–µ–º–µ–Ω—Ç—ã —Å–ø–∏—Å–∫–æ–≤  
- `PageHeaderFragment` - –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü
- `PageFooterFragment` - –ø–æ–¥–≤–∞–ª—ã —Å—Ç—Ä–∞–Ω–∏—Ü
- `LayoutStyle` - —Å—Ç–∏–ª–∏ –¥–ª—è layout-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

### ‚úÖ 3. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ OCR –ø–∞–π–ø–ª–∞–π–Ω–∞
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:
- **Selectable text** - –¥–ª—è PDF —Å —Ç–µ–∫—Å—Ç–æ–º (–±—ã—Å—Ç—Ä–æ)
- **OCR** - –¥–ª—è –æ—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ)

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
documentor/
‚îú‚îÄ‚îÄ structuries/          # üß± –û—Å–Ω–æ–≤–∞ - —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ pipelines/           # üîÑ –ü–∞–π–ø–ª–∞–π–Ω—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ ocr/            # üéØ OCR –ø–∞–π–ø–ª–∞–π–Ω (–æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)
‚îú‚îÄ‚îÄ parsers/             # üìÑ –ü–∞—Ä—Å–µ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤
‚îî‚îÄ‚îÄ loaders/             # üìÅ –ó–∞–≥—Ä—É–∑—á–∏–∫–∏ —Ñ–∞–π–ª–æ–≤
```

### OCR Pipeline –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ú–æ–¥–µ–ª—å |
|-----------|------------|--------|
| `DotsOCRClient` | Layout detection | dots.ocr (–ø–æ—Ä—Ç 8069) |
| `QwenClient` | Text recognition | Qwen2.5-VL (–ø–æ—Ä—Ç 8070) |
| `DotsBlockDetector` | –î–µ—Ç–µ–∫—Ü–∏—è –±–ª–æ–∫–æ–≤ | dots.ocr |
| `QwenBlockRecognizer` | –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ | Qwen2.5-VL |
| `PDFProcessor` | –ì–ª–∞–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä | –ì–∏–±—Ä–∏–¥–Ω—ã–π |

## üîÑ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. PDFProcessor (–ì–ª–∞–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä)

```mermaid
graph TD
    A[PDF + Page Image] --> B{–ï—Å—Ç—å selectable text?}
    B -->|–î–∞| C[–ò–∑–≤–ª–µ—á—å —Ç–µ–∫—Å—Ç –∏–∑ PDF]
    B -->|–ù–µ—Ç| D[OCR Pipeline]
    C --> E[–°–æ–∑–¥–∞—Ç—å ParagraphFragment]
    D --> F[dots.ocr Layout Detection]
    F --> G[Qwen2.5-VL Text Recognition]
    G --> H[–°–æ–∑–¥–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ Fragment]
    E --> I[–†–µ–∑—É–ª—å—Ç–∞—Ç: List Fragment]
    H --> I
```

### 2. OCR Pipeline (Fallback)

```mermaid
graph TD
    A[Image] --> B[DotsBlockDetector]
    B --> C[dots.ocr: Layout Detection]
    C --> D[Block objects —Å bbox + category]
    D --> E[QwenBlockRecognizer]
    E --> F[Qwen2.5-VL: Text Recognition]
    F --> G[Fragment objects]
```

## üì¶ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```toml
# OCR dependencies
"openai>=1.0.0,<2.0.0",           # API –∫–ª–∏–µ–Ω—Ç
"pillow>=10.0.0,<11.0.0",         # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
"pypdf2>=3.0.0,<4.0.0",           # PDF –æ–±—Ä–∞–±–æ—Ç–∫–∞
"langchain-core>=0.1.0,<1.0.0",   # LangChain –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
"overrides>=7.0.0,<8.0.0",        # –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã
```

### API –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```python
# dots.ocr (Layout Detection)
dots_ocr_config = APIConfig(
    base_url="http://localhost:8069/v1",
    api_key="security-token-abc123",
    model_name="/model"
)

# Qwen2.5-VL (Text Recognition)  
qwen_config = APIConfig(
    base_url="http://localhost:8070/v1",
    api_key="security-token-abc123", 
    model_name="/model"
)
```

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
- **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**: PNG, JPEG, JPG, GIF, WEBP
- **PDF**: –° selectable text –∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
- **–õ—é–±–æ–π —Ñ–æ—Ä–º–∞—Ç PIL** —á–µ—Ä–µ–∑ `Image.open()`

## üéØ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### 1. –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥
- **Selectable text** - –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–ª—è PDF —Å —Ç–µ–∫—Å—Ç–æ–º
- **OCR** - –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä** –ª—É—á—à–µ–≥–æ –º–µ—Ç–æ–¥–∞

### 2. –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å
- –ö–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –¥–µ—Ç–µ–∫—Ç–æ—Ä—ã/—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç–µ–ª–∏
- –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

### 3. –ö–∞—á–µ—Å—Ç–≤–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
- `dots.ocr` - —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –Ω–∞ layout detection
- `Qwen2.5-VL` - —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –Ω–∞ text recognition
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ = –ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ

### 4. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- Selectable text –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- OCR –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è –º–æ–¥–µ–ª–µ–π

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ OCR –ø–∞–π–ø–ª–∞–π–Ω–∞

```
pipelines/ocr/
‚îú‚îÄ‚îÄ __init__.py              # –≠–∫—Å–ø–æ—Ä—Ç—ã
‚îú‚îÄ‚îÄ api_client.py            # –ë–∞–∑–æ–≤—ã–π API –∫–ª–∏–µ–Ω—Ç
‚îú‚îÄ‚îÄ config.py                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ dots_ocr_client.py       # –ö–ª–∏–µ–Ω—Ç dots.ocr
‚îú‚îÄ‚îÄ qwen_client.py           # –ö–ª–∏–µ–Ω—Ç Qwen2.5-VL
‚îú‚îÄ‚îÄ detector.py              # –î–µ—Ç–µ–∫—Ç–æ—Ä –±–ª–æ–∫–æ–≤
‚îú‚îÄ‚îÄ recognizer.py            # –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç–µ–ª—å —Ç–µ–∫—Å—Ç–∞
‚îú‚îÄ‚îÄ category_mapping.py      # –ú–∞–ø–ø–∏–Ω–≥ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
‚îú‚îÄ‚îÄ prompts.py               # –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ interfaces.py            # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –ø–∞–π–ø–ª–∞–π–Ω–∞
‚îú‚îÄ‚îÄ pipeline.py              # –ë–∞–∑–æ–≤—ã–π –ø–∞–π–ø–ª–∞–π–Ω
‚îú‚îÄ‚îÄ pdf_processor.py         # üéØ –ì–õ–ê–í–ù–´–ô –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä PDF
‚îú‚îÄ‚îÄ example.py               # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îî‚îÄ‚îÄ qwen_example.py          # –ü—Ä–∏–º–µ—Ä—ã Qwen
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ—Å—Ç–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
```python
from documentor.pipelines.ocr import PDFProcessor, OCRPipelineConfig
from PIL import Image

# –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
config = OCRPipelineConfig.create_default()
processor = PDFProcessor(config)

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
image = Image.open("scan.png")
fragments = processor.process_image(image)

for fragment in fragments:
    print(f"{type(fragment).__name__}: {fragment.value}")
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ PDF —Å selectable text
```python
# –û–±—Ä–∞–±–æ—Ç–∫–∞ PDF —Å—Ç—Ä–∞–Ω–∏—Ü—ã
fragments = processor.process_pdf_page("document.pdf", page_image, page_num=0)

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–µ—Ä–µ—Ç –ª—É—á—à–∏–π –º–µ—Ç–æ–¥:
# - Selectable text (–±—ã—Å—Ç—Ä–æ) –µ—Å–ª–∏ –µ—Å—Ç—å
# - OCR (–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ) –µ—Å–ª–∏ –Ω–µ—Ç
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```python
from documentor.pipelines.ocr import OCRPipelineConfig, APIConfig

# –ö–∞—Å—Ç–æ–º–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
config = OCRPipelineConfig(
    dots_ocr_config=APIConfig(
        base_url="http://localhost:8069/v1",
        api_key="your-key"
    ),
    qwen_config=APIConfig(
        base_url="http://localhost:8070/v1", 
        api_key="your-key"
    )
)
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤
- ‚úÖ **–ò–º–ø–æ—Ä—Ç—ã**: –í—Å–µ –º–æ–¥—É–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è
- ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**: –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (1705x2203 –ø–∏–∫—Å–µ–ª–µ–π)
- ‚úÖ **PDF**: –û–±—Ä–∞–±–æ—Ç–∫–∞ PDF —Ñ–∞–π–ª–æ–≤ (671KB)
- ‚úÖ **OCR Pipeline**: –£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ 8 —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- ‚úÖ **Layout Detection**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Ç–∏–ø—ã —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ (PageHeader, Header, Paragraph, Footnote)
- ‚úÖ **Text Recognition**: –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Å bbox –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏

### –¢–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã
- `example.jpg` - —Ç–µ—Å—Ç–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (670KB)
- `example.pdf` - —Ç–µ—Å—Ç–æ–≤—ã–π PDF (671KB)

### –ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ OCR
```
üñºÔ∏è –¢–µ—Å—Ç–∏—Ä—É–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: example.jpg
‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ: 1705x2203 –ø–∏–∫—Å–µ–ª–µ–π
‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –ù–∞–π–¥–µ–Ω–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤: 8

--- –§—Ä–∞–≥–º–µ–Ω—Ç 1 ---
–¢–∏–ø: PageHeaderFragment
–¢–µ–∫—Å—Ç: This article was downloaded by: [130.132.123.28]
–°—Ç–∏–ª—å: {'confidence': 1.0, 'bbox': (53, 53, 716, 81), 'source': 'qwen2.5-vl'}

--- –§—Ä–∞–≥–º–µ–Ω—Ç 2 ---
–¢–∏–ø: HeaderFragment  
–¢–µ–∫—Å—Ç: Archives of Environmental Health: An International Journal
–°—Ç–∏–ª—å: {'confidence': 1.0, 'bbox': (445, 274, 1449, 356), 'source': 'qwen2.5-vl'}

--- –§—Ä–∞–≥–º–µ–Ω—Ç 3 ---
–¢–∏–ø: ParagraphFragment
–¢–µ–∫—Å—Ç: Publication details, including instructions for authors...
–°—Ç–∏–ª—å: {'confidence': 1.0, 'bbox': (445, 368, 1420, 427), 'source': 'qwen2.5-vl'}
```

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –§–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã/–∏–∑–º–µ–Ω–µ–Ω—ã
- **–ù–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤**: 15+ —Ñ–∞–π–ª–æ–≤ OCR –ø–∞–π–ø–ª–∞–π–Ω–∞
- **–ò–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤**: 10+ —Ñ–∞–π–ª–æ–≤ –≤ structuries/
- **–ù–æ–≤—ã—Ö —Ç–∏–ø–æ–≤ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤**: 5 —Ç–∏–ø–æ–≤
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞**: 1000+ —Å—Ç—Ä–æ–∫

### –ú–æ–¥—É–ª–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
| –ú–æ–¥—É–ª—å | –°—Ç–∞—Ç—É—Å | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
|--------|--------|---------------|
| `pipelines/ocr/` | ‚úÖ **–ê–∫—Ç–∏–≤–µ–Ω** | –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å |
| `structuries/` | ‚ö†Ô∏è **–ß–∞—Å—Ç–∏—á–Ω–æ** | –¢–æ–ª—å–∫–æ –≤ OCR –ø–∞–π–ø–ª–∞–π–Ω–µ |
| `parsers/` | ‚ùå **–ù–µ–∞–∫—Ç–∏–≤–µ–Ω** | –¢–æ–ª—å–∫–æ –≤ —Ç–µ—Å—Ç–∞—Ö |
| `loaders/` | ‚ùå **–ù–µ–∞–∫—Ç–∏–≤–µ–Ω** | –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã
- **–ü—Ä–æ–±–ª–µ–º–∞**: `QwenClient` –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞–ª `process_image`
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `process_image` ‚Üí `recognize_text`

### 2. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- **–ü—Ä–æ–±–ª–µ–º–∞**: –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω—ã –≤ `pyproject.toml` –∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã

### 3. –ò–º–ø–æ—Ä—Ç—ã
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ê–±—Å–æ–ª—é—Ç–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã —Å–Ω–∏–∂–∞–ª–∏ –ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å
- **–†–µ—à–µ–Ω–∏–µ**: –ü–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –Ω–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ
1. **–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π OCR –ø–∞–π–ø–ª–∞–π–Ω** –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ PDF –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
2. **–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥** - selectable text + OCR
3. **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ–º–∞—è
4. **–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ** - —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
5. **–ü—Ä–æ—Å—Ç–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** - –æ–¥–∏–Ω –∫–ª–∞—Å—Å `PDFProcessor`

### üöÄ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- –ö–æ–¥ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω
- –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞

### ‚è±Ô∏è Sequence Diagram

```mermaid
sequenceDiagram
    participant User
    participant Pipeline as ScanPipeline
    participant Detector as DotsBlockDetector
    participant DotsOCR as DotsOCRClient
    participant Recognizer as QwenBlockRecognizer
    participant Qwen as QwenClient
    participant Factory as "FragmentFactory"

    User->>Pipeline: process(image)
    
    Note over Pipeline: –≠—Ç–∞–ø 1: Layout Detection<br/>—Ç–æ–ª—å–∫–æ bbox + category
    activate Pipeline
    Pipeline->>Detector: detect(image)
    activate Detector
    Detector->>DotsOCR: process_image(image)
    activate DotsOCR
    DotsOCR-->>Detector: JSON (bbox, category)<br/>—Ç–µ–∫—Å—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
    deactivate DotsOCR
    Detector-->>Pipeline: List<Block>
    deactivate Detector

    Note over Pipeline: –≠—Ç–∞–ø 2: –ü–æ–ª–Ω–æ–µ OCR-—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ<br/>—á–µ—Ä–µ–∑ Qwen2.5-VL
    Pipeline->>Recognizer: recognize(blocks)
    activate Recognizer

    loop –î–ª—è –∫–∞–∂–¥–æ–≥–æ Block
        Recognizer->>Qwen: recognize_text(block.image)
        activate Qwen
        Qwen-->>Recognizer: extracted text (Markdown/LaTeX)
        deactivate Qwen
        Recognizer->>Factory: createFragment(type, value=text)
    end

    Recognizer-->>Pipeline: Iterator[Fragment]
    deactivate Recognizer
    Pipeline-->>User: Iterator[Fragment]
    deactivate Pipeline

    Note right of Pipeline: –í—Å–µ –±–ª–æ–∫–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç<br/>—á–µ—Ä–µ–∑ Qwen ‚Äî<br/>–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
```
